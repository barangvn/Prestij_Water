<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Su Arıtma Takip Sistemi</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: space-between;
            padding: 20px;
        }
        .container {
            display: flex;
            flex-direction: column;
            width: 45%;
            margin-right: 10px;
        }
        .form-group {
            margin-bottom: 10px;
        }
        label {
            display: block;
            font-weight: bold;
        }
        input {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
        }
        button {
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        ul {
            list-style-type: none;
            padding: 0;
        }
        li {
            padding: 8px;
            margin: 5px 0;
            background-color: #f1f1f1;
            border-radius: 5px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Müşteri Ekle</h2>
        <div class="form-group">
            <label for="customerName">Müşteri Adı:</label>
            <input type="text" id="customerName">
        </div>
        <div class="form-group">
            <label for="customerAddress">Adres:</label>
            <input type="text" id="customerAddress">
        </div>
        <div class="form-group">
            <label for="customerPhone">Telefon:</label>
            <input type="text" id="customerPhone">
        </div>
        <button onclick="addCustomer()">Müşteri Ekle</button>
        
        <h2>Müşteriler</h2>
        <ul id="customerList"></ul>
    </div>

    <div class="container">
        <h2>Stok Ekle</h2>
        <div class="form-group">
            <label for="stockName">Ürün Adı:</label>
            <input type="text" id="stockName">
        </div>
        <div class="form-group">
            <label for="stockQuantity">Adet:</label>
            <input type="number" id="stockQuantity">
        </div>
        <div class="form-group">
            <label for="criticalStock">Kritik Stok Adedi:</label>
            <input type="number" id="criticalStock">
        </div>
        <button onclick="addStockItem()">Stok Ekle</button>
        
        <h2>Stoklar</h2>
        <ul id="stockList"></ul>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>

    <script>
        // Firebase yapılandırması
        const firebaseConfig = {
            apiKey: "AIzaSyAmW3qdlm49cvfVeP27DaAMGJwtKDJ6kyI",
            authDomain: "prestij-water.firebaseapp.com",
            databaseURL: "https://prestij-water-default-rtdb.firebaseio.com",
            projectId: "prestij-water",
            storageBucket: "prestij-water.firebasestorage.app",
            messagingSenderId: "712467125722",
            appId: "1:712467125722:web:e845679e5d456fda2f5ce3",
            measurementId: "G-G0ZYR03RVL"
        };

        // Firebase'i başlatma
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.database(app);

        // Müşteri verilerini Firebase'den alıp ekrana yazdırma
        function fetchCustomers() {
            const customerRef = db.ref('customers');
            customerRef.once('value').then(snapshot => {
                const customers = snapshot.val();
                const customerList = document.getElementById('customerList');
                customerList.innerHTML = ''; // Listeyi temizle
                for (const id in customers) {
                    const customer = customers[id];
                    const li = document.createElement('li');
                    li.textContent = `Ad: ${customer.name}, Adres: ${customer.address}, Telefon: ${customer.phone}`;
                    customerList.appendChild(li);
                }
            });
        }

        // Stok verilerini Firebase'den alıp ekrana yazdırma
        function fetchStockItems() {
            const stockRef = db.ref('stock');
            stockRef.once('value').then(snapshot => {
                const stockItems = snapshot.val();
                const stockList = document.getElementById('stockList');
                stockList.innerHTML = ''; // Listeyi temizle
                for (const id in stockItems) {
                    const item = stockItems[id];
                    const li = document.createElement('li');
                    li.textContent = `Ürün: ${item.name}, Adet: ${item.quantity}, Kritik Stok: ${item.criticalStock}`;
                    stockList.appendChild(li);
                }
            });
        }

        // Müşteri ekleme fonksiyonu
        function addCustomer() {
            const name = document.getElementById('customerName').value;
            const address = document.getElementById('customerAddress').value;
            const phone = document.getElementById('customerPhone').value;

            if (name && address && phone) {
                const customerRef = db.ref('customers');
                const newCustomerRef = customerRef.push();
                newCustomerRef.set({
                    name: name,
                    address: address,
                    phone: phone,
                    maintenanceHistory: [],
                    installationHistory: [],
                    repairHistory: []
                }).then(() => {
                    alert('Müşteri eklendi');
                    fetchCustomers(); // Müşterileri güncelle
                }).catch((error) => {
                    console.error("Müşteri eklenirken bir hata oluştu:", error);
                    alert("Bir hata oluştu. Lütfen tekrar deneyin.");
                });
            } else {
                alert('Lütfen tüm alanları doldurun');
            }
        }

        // Stok ekleme fonksiyonu
        function addStockItem() {
            const name = document.getElementById('stockName').value;
            const quantity = document.getElementById('stockQuantity').value;
            const criticalStock = document.getElementById('criticalStock').value;

            if (name && quantity && criticalStock) {
                const stockRef = db.ref('stock');
                const newStockRef = stockRef.push();
                newStockRef.set({
                    name: name,
                    quantity: quantity,
                    criticalStock: criticalStock
                }).then(() => {
                    alert('Stok eklendi');
                    fetchStockItems(); // Stokları güncelle
                }).catch((error) => {
                    console.error("Stok eklenirken bir hata oluştu:", error);
                    alert("Bir hata oluştu. Lütfen tekrar deneyin.");
                });
            } else {
                alert('Lütfen tüm alanları doldurun');
            }
        }

        // Sayfa yüklendiğinde verileri çek
        fetchCustomers();
        fetchStockItems();
    </script>

</body>
</html>
